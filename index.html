<!DOCTYPE html>
<html lang="es">
<head>
ย ย <meta charset="UTF-8">
ย ย <meta name="viewport" content="width=device-width, initial-scale=1.0">
ย ย <title>Reporte de Inspecciรณn Estructural - Entel</title>
ย ย <style>
ย ย ย ย /* ESTILOS BASE */
ย ย ย ย body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 20px; background-color: #f4f6f9; }
ย ย ย ย 
ย ย ย ย .excel-container {
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย max-width: 1300px;
ย ย ย ย ย ย margin: 0 auto;
ย ย ย ย ย ย border: 1px solid #c0c0c0;
ย ย ย ย ย ย box-shadow: 0 4px 15px rgba(0,0,0,0.1);
ย ย ย ย ย ย background-color: white;
ย ย ย ย ย ย padding: 15px;
ย ย ย ย }

ย ย ย ย table { border-collapse: collapse; width: 100%; table-layout: fixed; }
ย ย ย ย 
ย ย ย ย /* CELDAS Y BORDES */
ย ย ย ย th, td { 
ย ย ย ย ย ย border: 1px solid #a0a0a0; 
ย ย ย ย ย ย padding: 4px; 
ย ย ย ย ย ย height: 32px;
ย ย ย ย ย ย font-size: 11px; 
ย ย ย ย ย ย vertical-align: middle; 
ย ย ย ย }

ย ย ย ย /* ANCHOS DE COLUMNA (SIMULANDO EXCEL) */
ย ย ย ย .col-N { width: 30px; text-align: center; } 
ย ย ย ย .col-Pregunta { width: 40%; } 
ย ย ย ย .col-Select { width: 105px; text-align: center; } 
ย ย ย ย .col-Paraliza { width: 80px; }
ย ย ย ย .col-Coment { width: auto; }
ย ย ย ย 
ย ย ย ย /* ESTILO para los SELECTS */
ย ย ย ย .select-input {
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย height: 100%;
ย ย ย ย ย ย border: none;
ย ย ย ย ย ย padding: 4px;
ย ย ย ย ย ย font-size: 12px;
ย ย ย ย ย ย background-color: transparent;
ย ย ย ย ย ย cursor: pointer;
ย ย ย ย ย ย text-align-last: center;
ย ย ย ย ย ย font-weight: 500;
ย ย ย ย }
ย ย ย ย .select-input:focus {
ย ย ย ย ย ย background-color: #e8f0fe;
ย ย ย ย ย ย outline: none;
ย ย ย ย }
ย ย ย ย /* Color dinรกmico para las opciones */
ย ย ย ย option[value="SI"] { color: red; font-weight: bold; }
ย ย ย ย option[value="NO"] { color: green; }
ย ย ย ย option[value="NA"] { color: gray; }

ย ย ย ย /* HEADER COLORES */
ย ย ย ย .header-blue { background-color: #4472c4; color: white; font-weight: bold; padding: 5px; }
ย ย ย ย .header-dark { background-color: #203764; color: white; font-weight: bold; text-align: center; }
ย ย ย ย .sub-header { background-color: #dae3f3; font-weight: bold; color: #203764; }

ย ย ย ย /* INPUTS DE TEXTO */
ย ย ย ย input[type="text"], input[type="date"], input[type="number"] {
ย ย ย ย ย ย width: 100%; height: 100%; border: none; padding: 2px 5px; 
ย ย ย ย ย ย font-family: inherit; font-size: 11px; background-color: transparent;
ย ย ย ย }
ย ย ย ย input:focus { background-color: #fffacd; outline: 1px solid #f1c40f; }
ย ย ย ย 
ย ย ย ย .cell-center { text-align: center; }
ย ย ย ย 
ย ย ย ย /* RESULTADOS CALCULADOS (Disabled/Readonly) */
ย ย ย ย .read-only-result {
ย ย ย ย ย ย background-color: #dcdcdc; /* Color gris para simular deshabilitado */
ย ย ย ย ย ย border: 1px solid #999;
ย ย ย ย ย ย display: block;
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย height: 100%;
ย ย ย ย ย ย padding: 4px;
ย ย ย ย ย ย box-sizing: border-box;
ย ย ย ย ย ย font-size: 12px;
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย ย ย color: #444;
ย ย ย ย }
ย ย ย ย 
ย ย ย ย /* LOGO */
ย ย ย ย .entel-logo { font-size: 24px; font-weight: 800; color: #005cbb; font-style: italic; }
ย ย ย ย .entel-e { color: #ff6600; }

ย ย ย ย /* SUBIDA DE FOTO */
ย ย ย ย .photo-section {
ย ย ย ย ย ย margin-top: 20px; border: 2px dashed #4472c4; background: #f8faff; padding: 20px; text-align: center;
ย ย ย ย }

ย ย ย ย /* BOTONES */
ย ย ย ย .btn-submit {
ย ย ย ย ย ย background-color: #4472c4; color: white; border: none; padding: 12px 40px; 
ย ย ย ย ย ย font-size: 16px; font-weight: bold; border-radius: 4px; cursor: pointer; margin-top: 15px;
ย ย ย ย ย ย transition: background 0.3s;
ย ย ย ย }
ย ย ย ย .btn-submit:hover { background-color: #365a9e; }
ย ย ย ย .btn-submit:disabled { background-color: #ccc; cursor: not-allowed; }

ย ย ย ย #status-msg { margin-top: 10px; font-weight: bold; }
ย ย ย ย .text-success { color: #27ae60; }
ย ย ย ย .text-error { color: #c0392b; }
ย ย </style>
</head>
<body>

<form id="reporte-form" class="excel-container">
ย ย <table>
ย ย ย ย <tr>
ย ย ย ย ย ย <td colspan="3" class="cell-center"><div class="entel-logo"><span class="entel-e">e</span>) entel</div></td>
ย ย ย ย ย ย <td colspan="4" class="header-blue">TIPO DE DOCUMENTO: FORMATO</td>
ย ย ย ย ย ย <td colspan="3" class="header-blue">VERSIรN: 1</td>
ย ย ย ย ย ย <td colspan="3" class="header-blue">CรDIGO: IM.F-007</td>
ย ย ย ย </tr>

ย ย ย ย <tr><td colspan="13" class="header-blue">I. DATOS DEL COOPERADOR</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย ย ย ย ย ย ย <td colspan="4"><input type="text" name="personal_01_nombre" placeholder="Nombre Cooperador"></td>
ย ย ย ย ย ย ย ย ย ย ย ย <td colspan="2"><input type="text" name="personal_01_cargo" placeholder="Cargo"></td>
ย ย ย ย ย ย ย ย ย ย ย ย <td colspan="3"><input type="text" name="personal_01_empresa" placeholder="Empresa"></td>
ย ย ย ย ย ย <td colspan="2"></td>
ย ย ย ย ย ย ย ย ย ย ย ย <td colspan="2"><input type="text" name="personal_01_dni" placeholder="DNI"></td>
ย ย ย ย </tr>

ย ย ย ย <tr><td colspan="13" class="header-blue">II. DATOS DEL PROYECTO Y SITE</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td colspan="3" class="header-blue">Nombre Site:</td>
ย ย ย ย ย ย ย ย ย ย ย ย <td colspan="3"><input type="text" name="nombre_site" required placeholder="Ej: LIMA CENTRO"></td>
ย ย ย ย ย ย <td colspan="4" class="header-blue">Prioridad:</td>
ย ย ย ย ย ย <td colspan="3"><input type="text" name="prioridad"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td colspan="3" class="header-blue">Direcciรณn:</td>
ย ย ย ย ย ย <td colspan="10"><input type="text" name="direccion"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td colspan="3" class="header-blue">Distrito/Prov/Dpto:</td>
ย ย ย ย ย ย ย ย ย ย ย ย <td colspan="3"><input type="text" name="distrito" placeholder="Lima"></td>
ย ย ย ย ย ย <td colspan="4" class="header-blue">Tipo de Sitio:</td>
ย ย ย ย ย ย ย ย ย ย ย ย <td colspan="3"><input type="text" name="tipo_sitio" placeholder="Torre / Monopolo / Rooftop"></td>
ย ย ย ย </tr>

ย ย ย ย <tr><td colspan="13" class="header-blue">III. DATOS DEL INSPECTOR</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td colspan="4"><input type="text" name="inspector_nombre" placeholder="Nombre Inspector"></td>
ย ย ย ย ย ย <td colspan="2"><input type="text" name="inspector_cargo" placeholder="Cargo"></td>
ย ย ย ย ย ย <td colspan="3"><input type="text" name="inspector_empresa" placeholder="Empresa"></td>
ย ย ย ย ย ย <td colspan="4"><input type="text" name="inspector_dni" placeholder="DNI"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td colspan="4" class="header-blue">Fecha de Inspecciรณn:</td>
ย ย ย ย ย ย ย ย ย ย ย ย <td colspan="2"><input type="date" name="fecha_inicio" required></td>
ย ย ย ย ย ย <td colspan="3" class="header-blue">Fecha fin supervisiรณn (No se usa, solo visual)</td>
ย ย ย ย ย ย <td colspan="4"><input type="date" name="fecha_fin"></td>
ย ย ย ย </tr>

ย ย ย ย <tr><td colspan="13" class="header-blue">IV. PREGUNTAS DE VERIFICACIรN DE ESTRUCTURA</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N header-dark">Nยฐ</td>
ย ย ย ย ย ย <td class="col-Pregunta header-dark" colspan="2">Preguntas</td>
ย ย ย ย ย ย <td class="col-Select header-dark" colspan="3">Respuesta (SI/NO/NA)</td> <td class="col-Paraliza header-dark" colspan="2">Aplica Paralizaciรณn</td>
ย ย ย ย ย ย <td class="col-Coment header-dark" colspan="5">Comentarios</td>
ย ย ย ย </tr>

ย ย ย ย <tr class="sub-header"><td colspan="13">CIMENTACIรN - CONDICIONES DEL CONCRETO</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">1</td>
ย ย ย ย ย ย <td colspan="2">Presenta fisuras en el concreto</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_concreto_1" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_concreto_1_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_concreto_1_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">2</td>
ย ย ย ย ย ย <td colspan="2">Presenta desprendimientos</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_concreto_2" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_concreto_2_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_concreto_2_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">3</td>
ย ย ย ย ย ย <td colspan="2">Presenta humedad</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_concreto_3" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_concreto_3_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_concreto_3_comentario"></td>
ย ย ย ย </tr>

ย ย ย ย <tr class="sub-header"><td colspan="13">CIMENTACIรN - ESTADO DE ANCLAJES</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">4</td>
ย ย ย ย ย ย <td colspan="2">Presenta grouting</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_anclaje_1" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_anclaje_1_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_anclaje_1_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">5</td>
ย ย ย ย ย ย <td colspan="2">Presenta codo (รณxido)</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_anclaje_2" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_anclaje_2_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_anclaje_2_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">6</td>
ย ย ย ย ย ย <td colspan="2">Presenta tuerca y contra tuerca</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_anclaje_3" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_anclaje_3_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_anclaje_3_comentario"></td>
ย ย ย ย </tr>

ย ย ย ย <tr class="sub-header"><td colspan="13">CIMENTACIรN - ESTADO DE PLANCHA BASE</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">7</td>
ย ย ย ย ย ย <td colspan="2">Presenta deformaciรณn</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_base_1" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_base_1_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_base_1_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">8</td>
ย ย ย ย ย ย <td colspan="2">Presenta codo</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_base_2" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_base_2_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_base_2_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">9</td>
ย ย ย ย ย ย <td colspan="2">Presenta fisuras en la plancha</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_base_3" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_base_3_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_base_3_comentario"></td>
ย ย ย ย </tr>

ย ย ย ย <tr class="sub-header"><td colspan="13">ESTRUCTURA METALICA - CONEXIONES</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">11</td>
ย ย ย ย ย ย <td colspan="2">Presenta pernos faltantes (>30%)</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_conexion_1" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_conexion_1_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_conexion_1_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">12</td>
ย ย ย ย ย ย <td colspan="2">Presenta รณxido en los pernos</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_conexion_2" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_conexion_2_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_conexion_2_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">13</td>
ย ย ย ย ย ย <td colspan="2">Presenta tuerca y contratuerca</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_conexion_3" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_conexion_3_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_conexion_3_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">14</td>
ย ย ย ย ย ย <td colspan="2">Presenta รณxido en planchas (codo)</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_estructura_1" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_estructura_1_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_estructura_1_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">15</td>
ย ย ย ย ย ย <td colspan="2">Presenta fisuras en la plancha</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_estructura_2" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_estructura_2_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_estructura_2_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">16</td>
ย ย ย ย ย ย <td colspan="2">Presenta fisuras en la soldadura</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_estructura_3" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_estructura_3_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_estructura_3_comentario"></td>
ย ย ย ย </tr>

ย ย ย ย <tr class="sub-header"><td colspan="13">OXIDACIรN Y CORROSIรN DE ELEMENTOS</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">17</td>
ย ย ย ย ย ย <td colspan="2">Presenta รณxido en montantes</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_corrosion_1" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_corrosion_1_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_corrosion_1_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">26</td>
ย ย ย ย ย ย <td colspan="2">Presenta corrosiรณn en horizontales</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_corrosion_10" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_corrosion_10_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_corrosion_10_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">33</td>
ย ย ย ย ย ย <td colspan="2">Presenta pรฉrdida de pintura</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_corrosion_17" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_corrosion_17_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_corrosion_17_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">34</td>
ย ย ย ย ย ย <td colspan="2">Presenta pรฉrdida de galvanizado</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_corrosion_18" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_corrosion_18_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_corrosion_18_comentario"></td>
ย ย ย ย </tr>

ย ย ย ย <tr class="sub-header"><td colspan="13">ALINEAMIENTO Y ESTABILIDAD</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">35</td>
ย ย ย ย ย ย <td colspan="2">Presenta deformaciรณn visible (>2%)</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_alineamiento_1" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_alineamiento_1_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_alineamiento_1_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">36</td>
ย ย ย ย ย ย <td colspan="2">Presenta movimiento perceptible</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_alineamiento_2" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_alineamiento_2_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_alineamiento_2_comentario"></td>
ย ย ย ย </tr>

ย ย ย ย <tr class="sub-header"><td colspan="13">ADICIONALES</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">40</td>
ย ย ย ย ย ย <td colspan="2">Presenta empozamiento de agua</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_adicional_1" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_adicional_1_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_adicional_1_comentario"></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td class="col-N cell-center">44</td>
ย ย ย ย ย ย <td colspan="2">Presenta crecimiento de vegetaciรณn</td>
ย ย ย ย ย ย <td colspan="3" class="cell-center">
ย ย ย ย ย ย ย ย <select name="p_adicional_5" class="select-input" required>
ย ย ย ย ย ย ย ย ย ย <option value="NA">NA</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="2" class="cell-center">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select name="p_adicional_5_paralizacion" class="select-input">
ย ย ย ย ย ย ย ย ย ย <option value="NO" selected>NO</option>
ย ย ย ย ย ย ย ย ย ย <option value="SI">SI</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </td>
ย ย ย ย ย ย <td colspan="5"><input type="text" name="p_adicional_5_comentario"></td>
ย ย ย ย </tr>

ย ย ย ย <tr><td colspan="13" class="header-blue">V. RESULTADO DE LA INSPECCIรN</td></tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td colspan="4" class="header-blue">Cantidad de SI/NO</td>
ย ย ย ย ย ย <td colspan="9"><span class="read-only-result">CALCULADO AUTOMรTICAMENTE</span></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td colspan="4" class="header-blue">Cantidad Preguntas Aplicables</td>
ย ย ย ย ย ย <td colspan="9"><span class="read-only-result">CALCULADO AUTOMรTICAMENTE</span></td>
ย ย ย ย </tr>
ย ย ย ย <tr>
ย ย ย ย ย ย <td colspan="4" class="header-blue">Calificaciรณn Lograda %</td>
ย ย ย ย ย ย <td colspan="9"><span class="read-only-result">CALCULADO AUTOMรTICAMENTE</span></td>
ย ย ย ย </tr>

ย ย ย ย <tr>
ย ย ย ย ย ย <td colspan="13">
ย ย ย ย ย ย ย ย <div class="photo-section">
ย ย ย ย ย ย ย ย ย ย <h3>๐ธ Adjuntar Reporte Fotogrรกfico (Hoja 4)</h3>
ย ย ย ย ย ย ย ย ย ย <input type="file" name="foto" accept="image/*" required>
ย ย ย ย ย ย ย ย ย ย <br><br>
ย ย ย ย ย ย ย ย ย ย <input type="text" name="descripcionFoto" placeholder="Descripciรณn breve de la foto (Opcional)" style="border:1px solid #ccc; padding:5px; width:50%;">
ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย <div style="text-align: center;">
ย ย ย ย ย ย ย ย ย ย <button type="submit" id="btnSubmit" class="btn-submit">Generar Reporte Excel</button>
ย ย ย ย ย ย ย ย ย ย <div id="status-msg"></div>
ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย </td>
ย ย ย ย </tr>

ย ย </table>
</form>

<script>
ย ย document.getElementById('reporte-form').addEventListener('submit', async (e) => {
ย ย ย ย e.preventDefault();
ย ย ย ย const btn = document.getElementById('btnSubmit');
ย ย ย ย const statusDiv = document.getElementById('status-msg');
ย ย ย ย const formData = new FormData(e.target);

ย ย ย ย // Validaciรณn Foto
ย ย ย ย if(!formData.get('foto').name) {
ย ย ย ย ย ย alert("โ๏ธ Debes subir una foto obligatoriamente.");
ย ย ย ย ย ย return;
ย ย ย ย }

ย ย ย ย btn.disabled = true;
ย ย ย ย btn.textContent = "โณ Generando Excel...";
ย ย ย ย statusDiv.textContent = "Procesando datos en Render...";
ย ย ย ย statusDiv.className = "";

ย ย ย ย try {
ย ย ย ย ย ย // ๐ด ยกIMPORTANTE! REEMPLAZA ESTA URL con la URL de tu backend en Render 
ย ย ย ย ย ย const URL_BACKEND = "https://backend-reportes-excel.onrender.com/generar-reporte"; 

ย ย ย ย ย ย const response = await fetch(URL_BACKEND, {
ย ย ย ย ย ย ย ย method: 'POST',
ย ย ย ย ย ย ย ย body: formData
ย ย ย ย ย ย });

ย ย ย ย ย ย if (!response.ok) throw new Error(await response.text());

ย ย ย ย ย ย const blob = await response.blob();
ย ย ย ย ย ย const url = window.URL.createObjectURL(blob);
ย ย ย ย ย ย const a = document.createElement('a');
ย ย ย ย ย ย a.href = url;
ย ย ย ย ย ย // Usamos 'nombre_site' para el nombre del archivo
ย ย ย ย ย ย a.download = `Reporte_${formData.get('nombre_site') || 'OOCC'}.xlsx`; 
ย ย ย ย ย ย document.body.appendChild(a);
ย ย ย ย ย ย a.click();
ย ย ย ย ย ย a.remove();

ย ย ย ย ย ย statusDiv.textContent = "โ ยกReporte descargado correctamente!";
ย ย ย ย ย ย statusDiv.className = "text-success";

ย ย ย ย } catch (error) {
ย ย ย ย ย ย console.error(error);
ย ย ย ย ย ย statusDiv.textContent = "โ Error: " + error.message;
ย ย ย ย ย ย statusDiv.className = "text-error";
ย ย ย ย } finally {
ย ย ย ย ย ย btn.disabled = false;
ย ย ย ย ย ย btn.textContent = "Generar Reporte Excel";
ย ย ย ย }
ย ย });
</script>

</body>
</html>